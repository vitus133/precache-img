apiVersion: v1
kind: Namespace
metadata:
  name: pre-cache
  annotations:
    workload.openshift.io/allowed: management
---
apiVersion: v1
kind: Pod
metadata:
  name: pre-cache
  namespace: pre-cache
spec:
  containers:
  - name: pre-cache-container
    image: quay.io/vgrinber/pre-cache:latest
    env:
    - name: REL_IMG
      value: quay.io/openshift-release-dev/ocp-release:4.9.4-x86_64
    - name: REDHAT_OPERATORS_INDEX
      value: registry.redhat.io/redhat/redhat-operator-index:v4.9
    - name: REDHAT_OPERATORS
      value: '"local-storage-operator", "performance-addon-operator", "ptp-operator", "sriov-network-operator"'
    command:
    - /bin/bash
    - -c
    - "sleep inf"
    # - /bin/bash
    # - -c
    # args:
    # - /usr/local/bin/release; /usr/local/bin/olm; sleep inf
    securityContext:
      privileged: true
      runAsUser: 0
    volumeMounts:
    - mountPath: /cache
      name: cache
    - mountPath: /var/lib/containers
      name: varlibcontainers
    - mountPath: /var/lib/kubelet
      name: varlibkubelet
  volumes:
  - name: cache
    emptyDir: {}
  - name: varlibcontainers
    hostPath:
      path: /var/lib/containers
  - name: varlibkubelet
    hostPath:
      path: /var/lib/kubelet
  restartPolicy: Never